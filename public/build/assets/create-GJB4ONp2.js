import{c as ps,e as hs,r as z,u as xs,j as s,y as Xe,a as ns,H as us}from"./app-B-1tTBzB.js";import{u as js,A as gs}from"./app-layout-AcA4QsYX.js";import{B as he}from"./button-CdeAIhWh.js";import{b as xe,a as ue,C as je,d as ge,c as fe}from"./card-CT4nWOXi.js";import{I as be}from"./input-NwLU5jqd.js";import{L as x}from"./label-dOfxTsEm.js";import{T as os}from"./textarea-DXpnT8gD.js";import{C as fs}from"./checkbox-B2V78Hni.js";import{c as cs}from"./date-formatters-B7sLoE7Z.js";import{c as S,a as D,S as A,b as P,d as j}from"./select-CFDDGV-d.js";import{Q as vs,C as Ns,a as bs,A as _s}from"./react-select-CEhiCd5L.js";import{B as rs}from"./badge-BVKIpfsD.js";import{S as We}from"./separator-CbSeUzAC.js";import{S as ys}from"./search-B6IKaY_0.js";import{T as Cs}from"./trash-2-Dvu-7uMw.js";import{P as Ss}from"./plus-NkEakcGv.js";import{S as Ds}from"./save-CMvnvL1o.js";import{A as As}from"./arrow-left-CPMTJ26O.js";/* empty css            */import"./index-tPtRDCGq.js";import"./index-DaH-z8Mm.js";import"./index-DPlNKk0B.js";import"./index-C-zLe_cF.js";import"./createLucideIcon-BXK2RHzG.js";import"./index-CbDHC5wl.js";import"./index-BH0NSEIh.js";import"./log-out-dgwnkcoL.js";import"./activity-Bl3eqAUz.js";import"./users-A7j-_B4j.js";import"./graduation-cap-D0BfXnZu.js";import"./clipboard-list-qhRWvK2l.js";import"./index-Cr2-Fx3K.js";import"./check-DWjkOdCd.js";import"./dialog-YGcrmEJm.js";import"./index-DywX51Id.js";const F=["Utente","Registo Cirúrgico","Diagnósticos","Intervenções","Dados Adicionais","Revisão e Confirmação"],Ps=[{title:"Dashboard",href:"/dashboard"},{title:"Registos Cirúrgicos",href:"/registos-cirurgicos"},{title:"Criar",href:"#"}];function Ai(i){const e=ps.c(169),{tiposDeCirurgia:_e,tiposDeOrigem:ye,diagnosticos:Ce,procedimentos:Se,especialidades:De,hospitals:Ae,zonaAnatomicas:Pe,enums:we,duplicateData:v}=i;let Re;e[0]!==_e?(Re=_e===void 0?[]:_e,e[0]=_e,e[1]=Re):Re=e[1];const k=Re;let Fe;e[2]!==ye?(Fe=ye===void 0?[]:ye,e[2]=ye,e[3]=Fe):Fe=e[3];const T=Fe;let ke;e[4]!==Ce?(ke=Ce===void 0?[]:Ce,e[4]=Ce,e[5]=ke):ke=e[5];const N=ke;let Te;e[6]!==Se?(Te=Se===void 0?[]:Se,e[6]=Se,e[7]=Te):Te=e[7];const w=Te;let Oe;e[8]!==De?(Oe=De===void 0?[]:De,e[8]=De,e[9]=Oe):Oe=e[9];const R=Oe;let Ve;e[10]!==Ae?(Ve=Ae===void 0?[]:Ae,e[10]=Ae,e[11]=Ve):Ve=e[11];const B=Ve;let Ee;e[12]!==Pe?(Ee=Pe===void 0?[]:Pe,e[12]=Pe,e[13]=Ee):Ee=e[13];const Ye=Ee;let Le;e[14]!==we?(Le=we===void 0?{sexo:[],funcoes:[],clavien:[],tipo_diagnostico:[]}:we,e[14]=we,e[15]=Le):Le=e[15];const f=Le,d=js(),{auth:$e}=hs().props,[a,Ze]=z.useState(1),[C,ls]=z.useState(v?.utente?.processo||""),[M,Ie]=z.useState(null);let Ue;e[16]!==v?.utente?(Ue=v?.utente||{nome:"",processo:"",data_nascimento:"",sexo:""},e[16]=v?.utente,e[17]=Ue):Ue=e[17];const[n,Q]=z.useState(Ue);let He;e[18]!==$e||e[19]!==v?.registo?(He=v?.registo||{hospital:$e.user.hospital_de_origem||"",especialidade:$e.user.especialidade||"",data_cirurgia:"",tipo_de_cirurgia_id:"",tipo_de_origem_id:"",ambulatorio:!1,observacoes:"",tipo_de_abordagem:""},e[18]=$e,e[19]=v?.registo,e[20]=He):He=e[20];const[r,O]=z.useState(He);let ze;e[21]!==v?.diagnosticos?(ze=v?.diagnosticos||[],e[21]=v?.diagnosticos,e[22]=ze):ze=e[22];const[o,G]=z.useState(ze),[ve,ds]=z.useState(N),{processing:Be}=xs();let Me;e[23]!==C||e[24]!==n?(Me=async()=>{if(C)try{const l=await(await fetch(`/api/utentes/processo/${C}`)).json();l.utente?(Q(l.utente),Ie(!0)):(Q({...n,processo:C}),Ie(!1))}catch(m){console.error("Error searching utente:",m)}},e[23]=C,e[24]=n,e[25]=Me):Me=e[25];const Ne=Me;let q,J,K,W,X,V,E,Y,Z,L,$,I,U,b;if(e[26]!==ve||e[27]!==N||e[28]!==o||e[29]!==v||e[30]!==f?.sexo||e[31]!==f?.tipo_diagnostico||e[32]!==R||e[33]!==B||e[34]!==d||e[35]!==r||e[36]!==C||e[37]!==Ne||e[38]!==a||e[39]!==k||e[40]!==T||e[41]!==n||e[42]!==M||e[43]!==Ye){const m=ve.map(Gs);let l;e[58]!==o?(l=t=>{const p=t.map(h=>{const _=o.find(pe=>pe.diagnostico_id===h);return _||{diagnostico_id:h,tipo:"",procedimentos:[{procedimento_id:"",funcao:"",clavien_dindo:"",anatomia_patologica:"",observacoes:""}]}});G(p)},e[58]=o,e[59]=l):l=e[59];const H=l;let c;e[60]!==o?(c=t=>{const p=[...o];p[t].procedimentos.push({procedimento_id:"",funcao:"",clavien_dindo:"",anatomia_patologica:"",observacoes:""}),G(p)},e[60]=o,e[61]=c):c=e[61],J=c;let u;e[62]!==o?(u=(t,p)=>{const h=[...o];h[t].procedimentos=h[t].procedimentos.filter((_,pe)=>pe!==p),G(h)},e[62]=o,e[63]=u):u=e[63],W=u;let g;e[64]!==o?(g=(t,p,h)=>{const _=[...o];_[t][p]=h,G(_)},e[64]=o,e[65]=g):g=e[65];const y=g;let qe;e[66]!==o?(qe=(t,p,h,_)=>{const pe=[...o];pe[t].procedimentos[p][h]=_,G(pe)},e[66]=o,e[67]=qe):qe=e[67],b=qe;let Je;e[68]!==o||e[69]!==r||e[70]!==a||e[71]!==n?(Je=t=>{if(t.preventDefault(),a!==6){Xe.warning("Por favor complete todos os passos antes de submeter");return}if(o.length===0){Xe.error("Adicione pelo menos um diagnóstico antes de submeter"),Ze(3);return}const p=o.map(Ms),h={utente:n,registo:r,diagnosticos:p};ns.post("/registos-cirurgicos",h,{onSuccess:Bs,onError:zs})},e[68]=o,e[69]=r,e[70]=a,e[71]=n,e[72]=Je):Je=e[72];const ms=Je;let Ke;e[73]!==o||e[74]!==r||e[75]!==a||e[76]!==n?(Ke=()=>{switch(a){case 1:return n.processo&&n.data_nascimento&&n.sexo;case 2:return r.hospital&&r.especialidade&&r.data_cirurgia&&r.tipo_de_cirurgia_id&&r.tipo_de_origem_id&&r.tipo_de_abordagem;case 3:return o.length>0&&o.every(Hs);case 4:return o.every($s);default:return!0}},e[73]=o,e[74]=r,e[75]=a,e[76]=n,e[77]=Ke):Ke=e[77],K=Ke,q=gs,I=Ps,e[78]===Symbol.for("react.memo_cache_sentinel")?(U=s.jsx(us,{title:"Criar Registo Cirúrgico"}),e[78]=U):U=e[78],Z=`flex flex-col gap-4 ${d?"p-4":"p-6"}`;const ts=`${d?"text-2xl":"text-3xl"} font-bold tracking-tight`,as=v?"Duplicar Registo":d?"Novo Registo":"Criar Registo Cirúrgico";let de;e[79]!==ts||e[80]!==as?(de=s.jsx("h1",{className:ts,children:as}),e[79]=ts,e[80]=as,e[81]=de):de=e[81];let me;e[82]!==d||e[83]!==a?(me=!d&&s.jsx("p",{className:"text-muted-foreground font-medium",children:F[a-1]}),e[82]=d,e[83]=a,e[84]=me):me=e[84],e[85]!==de||e[86]!==me?(L=s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[de,me]})}),e[85]=de,e[86]=me,e[87]=L):L=e[87],e[88]!==d||e[89]!==a?($=s.jsx("div",{className:"flex flex-col gap-2",children:d?s.jsxs("div",{className:"flex flex-col gap-1 px-1",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsxs("span",{className:"text-xs font-bold text-primary uppercase tracking-wider",children:["Passo ",a," de 6"]}),s.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:F[a-1]})]}),s.jsx("div",{className:"h-1.5 w-full bg-muted rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-primary transition-all duration-500 ease-out",style:{width:`${a/6*100}%`}})})]}):s.jsx("div",{className:"flex gap-2",children:F.map((t,p)=>{const h=p+1;return s.jsxs("div",{className:"flex-1 flex flex-col gap-2 items-center",children:[s.jsx("div",{className:`h-2 w-full rounded transition-colors duration-300 ${h<=a?"bg-primary":"bg-muted"}`,title:t}),s.jsx("span",{className:`text-[10px] uppercase tracking-wider font-semibold hidden md:block text-center ${h===a?"text-primary":"text-muted-foreground/50"}`,children:t})]},h)})})}),e[88]=d,e[89]=a,e[90]=$):$=e[90],X=ms,e[91]!==f?.sexo||e[92]!==C||e[93]!==Ne||e[94]!==a||e[95]!==n||e[96]!==M?(V=a===1&&s.jsxs(xe,{children:[s.jsxs(ue,{children:[s.jsx(je,{children:F[0]}),s.jsx(ge,{children:"Procure pelo nº de processo ou crie um novo utente"})]}),s.jsxs(fe,{className:"space-y-6",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(x,{htmlFor:"search_processo",children:"Nº de Processo"}),s.jsx(be,{id:"search_processo",type:"number",value:C,onChange:t=>{ls(t.target.value),Ie(null)},placeholder:"Digite o nº de processo"})]}),s.jsxs(he,{type:"button",onClick:Ne,className:"mt-auto",children:[s.jsx(ys,{className:"mr-2 h-4 w-4"}),"Procurar"]})]}),M!==null&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"rounded-md border p-4",children:M?s.jsx("p",{className:"text-sm text-green-600 font-medium",children:"✓ Utente encontrado"}):s.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"⚠ Utente não encontrado. Preencha os dados abaixo para criar."})}),s.jsx(We,{}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{htmlFor:"nome",children:"Nome"}),s.jsx(be,{id:"nome",value:n.nome,onChange:t=>Q({...n,nome:t.target.value}),placeholder:"Nome completo"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"processo",children:["Nº Processo ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(be,{disabled:!0,id:"processo",type:"number",value:n.processo,onChange:t=>Q({...n,processo:t.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"data_nascimento",children:["Data de Nascimento ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(be,{id:"data_nascimento",type:"date",value:n.data_nascimento,onChange:t=>Q({...n,data_nascimento:t.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"sexo",children:["Sexo ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:n.sexo,onValueChange:t=>Q({...n,sexo:t}),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione"})}),s.jsx(P,{children:(f?.sexo||[]).map(Ls)})]})]})]})]})]})]}),e[91]=f?.sexo,e[92]=C,e[93]=Ne,e[94]=a,e[95]=n,e[96]=M,e[97]=V):V=e[97],e[98]!==R||e[99]!==B||e[100]!==r||e[101]!==a||e[102]!==k||e[103]!==T?(E=a===2&&s.jsxs(xe,{children:[s.jsxs(ue,{children:[s.jsx(je,{children:F[1]}),s.jsx(ge,{children:"Dados da cirurgia"})]}),s.jsxs(fe,{className:"space-y-4",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"hospital",children:["Hospital de Origem ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:r.hospital,onValueChange:t=>O({...r,hospital:t}),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione o hospital de origem"})}),s.jsx(P,{children:B.length>0?B.map(Es):s.jsx(j,{value:"none",disabled:!0,children:"Nenhum hospital registado"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"especialidade",children:["Especialidade ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:r.especialidade,onValueChange:t=>O({...r,especialidade:t}),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione a especialidade"})}),s.jsx(P,{children:R.length>0?R.map(Vs):s.jsx(j,{value:"none",disabled:!0,children:"Nenhuma especialidade registada"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"data_cirurgia",children:["Data da Cirurgia ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(be,{id:"data_cirurgia",type:"date",value:r.data_cirurgia,onChange:t=>O({...r,data_cirurgia:t.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"tipo_de_cirurgia_id",children:["Tipo de Cirurgia ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:r.tipo_de_cirurgia_id,onValueChange:t=>O({...r,tipo_de_cirurgia_id:t}),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione"})}),s.jsx(P,{children:k.map(Os)})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"tipo_de_origem_id",children:["Origem ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:r.tipo_de_origem_id,onValueChange:t=>O({...r,tipo_de_origem_id:t}),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione"})}),s.jsx(P,{children:T.map(Ts)})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{htmlFor:"tipo_de_abordagem",children:["Tipo de Abordagem ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:r.tipo_de_abordagem,onValueChange:t=>O({...r,tipo_de_abordagem:t}),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione"})}),s.jsxs(P,{children:[s.jsx(j,{value:"Convencional",children:"Convencional"}),s.jsx(j,{value:"Laparoscópica",children:"Laparoscópica"}),s.jsx(j,{value:"Robótica",children:"Robótica"}),s.jsx(j,{value:"Endoscópica",children:"Endoscópica"}),s.jsx(j,{value:"Híbrida",children:"Híbrida"})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fs,{id:"ambulatorio",checked:r.ambulatorio,onCheckedChange:t=>O({...r,ambulatorio:!!t})}),s.jsx(x,{htmlFor:"ambulatorio",className:"cursor-pointer",children:"Ambulatório"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{htmlFor:"observacoes",children:"Observações Gerais"}),s.jsx(os,{id:"observacoes",value:r.observacoes,onChange:t=>O({...r,observacoes:t.target.value}),rows:3})]})]})]}),e[98]=R,e[99]=B,e[100]=r,e[101]=a,e[102]=k,e[103]=T,e[104]=E):E=e[104],Y=a===3&&s.jsxs(xe,{children:[s.jsx(ue,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(je,{children:F[2]}),s.jsx(ge,{children:"Selecione os diagnósticos da cirurgia"})]}),s.jsx(vs,{onCreated:t=>{if(t.id){const p=t.id.toString();ve.some(h=>h.id.toString()===p)||ds([...ve,{id:t.id,nome:t.nome}]),o.some(h=>h.diagnostico_id===p)||G([...o,{diagnostico_id:p,tipo:"",procedimentos:[{procedimento_id:"",funcao:"",clavien_dindo:"",anatomia_patologica:"",observacoes:""}]}])}},zonaAnatomicas:Ye})]})}),s.jsxs(fe,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{children:["Diagnósticos ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(Ns,{options:m,value:m.filter(t=>o.some(p=>p.diagnostico_id===t.value)),onChange:H,placeholder:"Selecione um ou mais diagnósticos..."})]}),o.length>0&&s.jsxs("div",{className:"space-y-4 pt-4",children:[s.jsx(We,{}),s.jsx("h3",{className:"text-sm font-medium",children:"Classificação dos Diagnósticos"}),o.map((t,p)=>{const h=N.find(_=>_.id.toString()===t.diagnostico_id)?.nome;return s.jsxs("div",{className:"grid grid-cols-2 gap-4 items-center p-3 border rounded-md",children:[s.jsx("span",{className:"text-sm font-medium",children:h}),s.jsx("div",{className:"space-y-1",children:s.jsxs(S,{value:t.tipo,onValueChange:_=>y(p,"tipo",_),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Tipo (Benigno/Maligno)"})}),s.jsx(P,{children:(f?.tipo_diagnostico||[]).map(ks)})]})})]},t.diagnostico_id)})]})]})]}),e[26]=ve,e[27]=N,e[28]=o,e[29]=v,e[30]=f?.sexo,e[31]=f?.tipo_diagnostico,e[32]=R,e[33]=B,e[34]=d,e[35]=r,e[36]=C,e[37]=Ne,e[38]=a,e[39]=k,e[40]=T,e[41]=n,e[42]=M,e[43]=Ye,e[44]=q,e[45]=J,e[46]=K,e[47]=W,e[48]=X,e[49]=V,e[50]=E,e[51]=Y,e[52]=Z,e[53]=L,e[54]=$,e[55]=I,e[56]=U,e[57]=b}else q=e[44],J=e[45],K=e[46],W=e[47],X=e[48],V=e[49],E=e[50],Y=e[51],Z=e[52],L=e[53],$=e[54],I=e[55],U=e[56],b=e[57];let ee;e[105]!==J||e[106]!==N||e[107]!==o||e[108]!==f?.funcoes||e[109]!==R||e[110]!==w||e[111]!==W||e[112]!==a||e[113]!==b?(ee=a===4&&s.jsxs(xe,{children:[s.jsxs(ue,{children:[s.jsx(je,{children:F[3]}),s.jsx(ge,{children:"Adicione os procedimentos para cada diagnóstico"})]}),s.jsx(fe,{className:"space-y-6",children:o.map((m,l)=>{const H=N.find(c=>c.id.toString()===m.diagnostico_id)?.nome;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(rs,{variant:"secondary",children:["Diagnóstico ",l+1]}),s.jsx("span",{className:"text-sm font-medium",children:H})]}),m.procedimentos.map((c,u)=>s.jsxs("div",{className:"rounded-md border p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(x,{children:["Intervenção ",u+1]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(bs,{especialidades:R,onCreated:g=>{g.id&&b(l,u,"procedimento_id",g.id.toString())}}),m.procedimentos.length>1&&s.jsx(he,{type:"button",variant:"ghost",size:"sm",onClick:()=>W(l,u),children:s.jsx(Cs,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{children:["Procedimento ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:c.procedimento_id,onValueChange:g=>b(l,u,"procedimento_id",g),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione"})}),s.jsx(P,{children:(w||[]).map(Fs)})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(x,{children:["Função ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(S,{value:c.funcao,onValueChange:g=>b(l,u,"funcao",g),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Selecione"})}),s.jsx(P,{children:(f?.funcoes||[]).map(Rs)})]})]})]})]},u)),s.jsxs(he,{type:"button",variant:"outline",size:"sm",onClick:()=>J(l),children:[s.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Adicionar Intervenção"]}),l<o.length-1&&s.jsx(We,{})]},l)})})]}),e[105]=J,e[106]=N,e[107]=o,e[108]=f?.funcoes,e[109]=R,e[110]=w,e[111]=W,e[112]=a,e[113]=b,e[114]=ee):ee=e[114];let se;e[115]!==N||e[116]!==o||e[117]!==f?.clavien||e[118]!==w||e[119]!==a||e[120]!==b?(se=a===5&&s.jsxs(xe,{children:[s.jsxs(ue,{children:[s.jsx(je,{children:F[4]}),s.jsx(ge,{children:"Informações complementares (opcional)"})]}),s.jsx(fe,{className:"space-y-6",children:o.map((m,l)=>{const H=N.find(c=>c.id.toString()===m.diagnostico_id)?.nome;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(rs,{variant:"secondary",children:["Diagnóstico ",l+1]}),s.jsx("span",{className:"text-sm font-medium",children:H})]}),m.procedimentos.map((c,u)=>{const g=w.find(y=>y.id.toString()===c.procedimento_id)?.nome;return s.jsxs("div",{className:"rounded-md border p-4 space-y-3",children:[s.jsxs(x,{className:"font-medium",children:["Intervenção ",u+1,": ",g]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{children:"Clavien-Dindo"}),s.jsxs(S,{value:c.clavien_dindo,onValueChange:y=>b(l,u,"clavien_dindo",y),children:[s.jsx(D,{children:s.jsx(A,{placeholder:"Nenhum"})}),s.jsxs(P,{children:[s.jsx(j,{value:"none",children:"Nenhum"}),(f?.clavien||[]).map(ws)]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{children:"Anatomia Patológica"}),s.jsx(os,{value:c.anatomia_patologica,onChange:y=>b(l,u,"anatomia_patologica",y.target.value),rows:2})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{children:"Observações Específicas"}),s.jsx(os,{value:c.observacoes,onChange:y=>b(l,u,"observacoes",y.target.value),rows:2})]})]},u)}),l<o.length-1&&s.jsx(We,{})]},l)})})]}),e[115]=N,e[116]=o,e[117]=f?.clavien,e[118]=w,e[119]=a,e[120]=b,e[121]=se):se=e[121];let ie;e[122]!==N||e[123]!==o||e[124]!==w||e[125]!==r||e[126]!==a||e[127]!==k||e[128]!==T||e[129]!==n?(ie=a===6&&s.jsxs(xe,{children:[s.jsxs(ue,{children:[s.jsx(je,{children:F[5]}),s.jsx(ge,{children:"Revise todos os dados antes de confirmar"})]}),s.jsxs(fe,{className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Utente"}),s.jsxs("div",{className:"rounded-md border p-4 space-y-1 text-sm bg-muted/30",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Nome:"})," ",n.nome]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Processo:"})," ",n.processo]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Data Nascimento:"})," ",cs(n.data_nascimento)]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Sexo:"})," ",n.sexo]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Registo Cirúrgico"}),s.jsxs("div",{className:"rounded-md border p-4 space-y-1 text-sm bg-muted/30",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Data:"})," ",cs(r.data_cirurgia)]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Tipo:"})," ",k.find(m=>m.id.toString()===r.tipo_de_cirurgia_id)?.nome]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Origem:"})," ",T.find(m=>m.id.toString()===r.tipo_de_origem_id)?.nome]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Abordagem:"})," ",r.tipo_de_abordagem]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Ambulatório:"})," ",r.ambulatorio?"Sim":"Não"]}),r.observacoes&&s.jsxs("p",{children:[s.jsx("span",{className:"text-muted-foreground mr-1",children:"Obs:"})," ",r.observacoes]})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Diagnósticos e Intervenções"}),s.jsx("div",{className:"space-y-3",children:o.map((m,l)=>{const H=N.find(c=>c.id.toString()===m.diagnostico_id)?.nome;return s.jsxs("div",{className:"rounded-md border p-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("p",{className:"font-medium",children:["Diagnóstico ",l+1,": ",H]}),m.tipo&&s.jsx(rs,{variant:m.tipo==="Maligno"?"destructive":"secondary",className:"text-[10px] h-5",children:m.tipo})]}),s.jsx("div",{className:"pl-4 space-y-2",children:m.procedimentos.map((c,u)=>{const g=w.find(y=>y.id.toString()===c.procedimento_id)?.nome;return s.jsxs("div",{className:"text-sm border-l-2 pl-3",children:[s.jsxs("p",{children:[s.jsxs("strong",{children:["Intervenção ",u+1,":"]})," ",g]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Função:"})," ",c.funcao]}),c.clavien_dindo&&c.clavien_dindo!=="none"&&s.jsxs("p",{children:[s.jsx("strong",{children:"Clavien-Dindo:"})," ",c.clavien_dindo]}),c.anatomia_patologica&&s.jsxs("p",{children:[s.jsx("strong",{children:"Anat. Patológica:"})," ",c.anatomia_patologica]}),c.observacoes&&s.jsxs("p",{children:[s.jsx("strong",{children:"Obs:"})," ",c.observacoes]})]},u)})})]},l)})})]})]})]}),e[122]=N,e[123]=o,e[124]=w,e[125]=r,e[126]=a,e[127]=k,e[128]=T,e[129]=n,e[130]=ie):ie=e[130];const es=`flex items-center justify-between pt-6 ${d?"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-md border-t p-4 z-50":""}`;let te;e[131]!==a?(te=()=>a>1?Ze(a-1):ns.visit("/registos-cirurgicos"),e[131]=a,e[132]=te):te=e[132];const ss=d?"flex-1 mr-2":"";let Qe;e[133]===Symbol.for("react.memo_cache_sentinel")?(Qe=s.jsx(As,{className:"mr-2 h-4 w-4"}),e[133]=Qe):Qe=e[133];const is=a===1?"Cancelar":d?"Anterior":"Passo Anterior";let ae;e[134]!==te||e[135]!==ss||e[136]!==is?(ae=s.jsxs(he,{type:"button",variant:"outline",onClick:te,className:ss,children:[Qe,is]}),e[134]=te,e[135]=ss,e[136]=is,e[137]=ae):ae=e[137];let oe;e[138]!==K||e[139]!==d||e[140]!==Be||e[141]!==a?(oe=a<6?s.jsxs(he,{type:"button",onClick:()=>Ze(a+1),disabled:!K(),className:d?"flex-1 ml-2":"",children:[d?"Próximo":"Próximo Passo",s.jsx(_s,{className:"ml-2 h-4 w-4"})]}):s.jsxs(he,{type:"submit",disabled:Be,className:`bg-emerald-600 hover:bg-emerald-700 ${d?"flex-1 ml-2":""}`,children:[s.jsx(Ds,{className:"mr-2 h-4 w-4"}),Be?"A guardar...":"Confirmar e Guardar"]}),e[138]=K,e[139]=d,e[140]=Be,e[141]=a,e[142]=oe):oe=e[142];let re;e[143]!==es||e[144]!==ae||e[145]!==oe?(re=s.jsxs("div",{className:es,children:[ae,oe]}),e[143]=es,e[144]=ae,e[145]=oe,e[146]=re):re=e[146];let ne;e[147]!==d?(ne=d&&s.jsx("div",{className:"h-20"}),e[147]=d,e[148]=ne):ne=e[148];let ce;e[149]!==X||e[150]!==V||e[151]!==E||e[152]!==Y||e[153]!==ee||e[154]!==se||e[155]!==ie||e[156]!==re||e[157]!==ne?(ce=s.jsxs("form",{onSubmit:X,children:[V,E,Y,ee,se,ie,re,ne," "]}),e[149]=X,e[150]=V,e[151]=E,e[152]=Y,e[153]=ee,e[154]=se,e[155]=ie,e[156]=re,e[157]=ne,e[158]=ce):ce=e[158];let le;e[159]!==Z||e[160]!==L||e[161]!==$||e[162]!==ce?(le=s.jsxs("div",{className:Z,children:[L,$,ce]}),e[159]=Z,e[160]=L,e[161]=$,e[162]=ce,e[163]=le):le=e[163];let Ge;return e[164]!==q||e[165]!==I||e[166]!==U||e[167]!==le?(Ge=s.jsxs(q,{breadcrumbs:I,children:[U,le]}),e[164]=q,e[165]=I,e[166]=U,e[167]=le,e[168]=Ge):Ge=e[168],Ge}function ws(i){return s.jsx(j,{value:i,children:i},i)}function Rs(i){return s.jsx(j,{value:i,children:i},i)}function Fs(i){return s.jsx(j,{value:i.id.toString(),children:i.nome},i.id)}function ks(i){return s.jsx(j,{value:i,children:i},i)}function Ts(i){return s.jsx(j,{value:i.id.toString(),children:i.nome},i.id)}function Os(i){return s.jsx(j,{value:i.id.toString(),children:i.nome},i.id)}function Vs(i){return s.jsx(j,{value:i.nome,children:i.nome},i.id)}function Es(i){return s.jsx(j,{value:i.nome,children:i.nome},i.id)}function Ls(i){return s.jsx(j,{value:i,children:i},i)}function $s(i){return i.procedimentos.every(Us)}function Us(i){return i.procedimento_id&&i.funcao}function Hs(i){return i.diagnostico_id}function zs(i){Xe.error("Erro ao criar registo cirúrgico. Verifique os dados."),console.error("=== VALIDATION ERRORS ===",i)}function Bs(){Xe.success("Registo cirúrgico criado com sucesso!")}function Ms(i){return{diagnostico_id:parseInt(i.diagnostico_id),tipo:i.tipo||null,procedimentos:i.procedimentos.map(Qs)}}function Qs(i){return{procedimento_id:parseInt(i.procedimento_id),funcao:i.funcao,clavien_dindo:i.clavien_dindo||null,anatomia_patologica:i.anatomia_patologica||null,observacoes:i.observacoes||null}}function Gs(i){return{value:i.id.toString(),label:i.nome}}export{Ai as default};
